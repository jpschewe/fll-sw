<?xml version="1.0" encoding="UTF-8"?>
<fll title="MN FIRST LEGO League Tournament" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="http://fll-sw.sourceforge.net/fll.xsd" revision="Rev: 1">
  
  <Performance minimumScore="0" weight="1.0">
    <goal name="wood_working" title="Wood Working" initialValue="0">
      <value score="25" title="Under table" value="under"/>
      <value score="15" title="In base" value="base"/>
      <value score="0" title="None" value="none"/>
    </goal>
    
    <goal name="medicine" title="Medicine in Base" multiplier="25"/>
    
    <goal name="service_animal" title="Service Animal in Base" multiplier="20"/>
    
    <goal name="bowling" title="Bowling Pins Down" multiplier="0" max="6"/>
    
    <computedGoal name="bowling_score" title="Bowling Pins Score">
      <switch>
        <case>
          <condition>
            <left>
              <term scoreType="raw" goal="bowling"/>
            </left>
            <equal-to/>
            <right>
              <constant value="6"/>
            </right>
          </condition>
          <result>
            <term scoreType="raw" coefficient="10" goal="bowling"/>
          </result>
      </case>
      <default>
        <term scoreType="raw" coefficient="7" goal="bowling"/>
      </default>
    </switch>
  </computedGoal>
  
  <goal name="strength_exercise" title="Weight Location" initialValue="0">
    <value score="25" title="High" value="high"/>
    <value score="15" title="Low" value="low"/>
    <value score="0" title="Below" value="below"/>
  </goal>
  
  <goal name="stove" title="All Burners Black" multiplier="25"/>
  
  <goal name="gardening" title="Plants in Garden" multiplier="25"/>
  
  <goal name="video_call" title="Video Call Flags Up" multiplier="20" max="2"/>
  
  <goal name="blue_quilting" title="Blue Quilts Touching" multiplier="15" max="2"/>
  
  <goal name="orange_quilting" title="Orange Quilts Touching" multiplier="30" max="2"/>
  
  <!-- TODO: Not have to zero-key this goal, so refs don't mess it up -->
  <goal name="cardio_exercise_major" title="Cardio Dot" multiplier="0" max="8" min="0" initialValue="2"/>
  <goal name="cardio_exercise_minor" title="Cardio Ticks" multiplier="0" max="5"/>
  <!-- 
  On the Challenge's image of the Pointer Position, it shows major and minor portions.
  The major portions are indicated by a physical LEGO light, while the minor portions
  are just evenly split. The Challenge just provided a chart keying major and minor
  ticks to scores, but that would be far too lengthy to transpose. If we look at the
  pattern of the score changes from tick to tick (1 increment = 1 tick), we can see it
  first increments by five points each time, then by three, then by one point. I 
  divided these up into progression scales. "Progression" is the total number of
  ticks from the bottom of the chart, leaving the default progression amount at 12 ticks.
  Progression scales:
    - Scale 1: Increment by 5 points, goes from progression 0 to progression 24
    - Scale 2: Increment by 3 points, goes from progression 25 to progression 36
      - Note: There is a 10 point bonus added at the jump from 6-0 to 6-1.
    - Scale 3: Increment by 1 points, ranges from progression 37 until progression 48

  To calculate a score based off of a major and minor tick, the following thought process
  occurs:
  
    - Compute total progression from the very bottom of the entire scale. 
      - Does it fit into scale 1? Compute and go. Add -60 point offset.
      - Does it fit into scale 2?
        - If so, we must first account for the minimum number of points one could recieve
          purely based off of the fact we're in scale 2. This number is 120 points. (progression 24)
          Next, we can use a coefficient to calculate the number of points to be added in in scale 2.
          
    The same happens for scale 3, and the subset of scale 2 with the 10 point bonus.
  -->
  <computedGoal name="cardio_progression" title="Cardio Progression">
    <variable name="major_zero_keyed">
      <term scoreType="raw" goal="cardio_exercise_major"/>
      <constant value="-1"/>
    </variable>
    <variable name="progression_scale_1">
      <term scoreType="raw" goal="cardio_exercise_major" coefficient="6"/>
      <term scoreType="raw" goal="cardio_exercise_minor"/>
    </variable>
    <variable name="progression_scale_1_max_points">
      <constant value="120"/>
    </variable>
    <variable name="progression_scale_2">
      <term scoreType="raw" goal="cardio_exercise_major" coefficient="6"/>
      <term scoreType="raw" goal="cardio_exercise_minor"/>
      <constant value="-24"/>
    </variable>
    <variable name="progression_scale_2_max_points">
      <constant value="166"/>
    </variable>
    <variable name="progression_scale_3">
      <term scoreType="raw" goal="cardio_exercise_major" coefficient="6"/>
      <term scoreType="raw" goal="cardio_exercise_minor"/>
      <constant value="-36"/>
    </variable>
    <variable name="bonus">
      <constant value="10"/>
    </variable>
    <variable name="offset">
      <constant value="-60"/>
    </variable>
    <switch>
      <case>
        <condition>
          <left>
            <variableRef variable="progression_scale_1"/>
          </left>
          <less-than-or-equal/>
          <right>
            <constant value="24"/>
          </right>
        </condition>
        <result>
          <variableRef variable="progression_scale_1" coefficient="5"/>
          <variableRef variable="offset"/>
        </result>
      </case>
      <case>
        <condition>
          <left>
            <variableRef variable="progression_scale_1"/>
          </left>
          <less-than-or-equal/>
          <right>
            <constant value="30"/>
          </right>
        </condition>
        <result>
          <variableRef variable="progression_scale_2" coefficient="3"/>
          <variableRef variable="offset"/>
          <variableRef variable="progression_scale_1_max_points"/>
        </result>
      </case>
      <case>
        <condition>
          <left>
            <variableRef variable="progression_scale_1"/>
          </left>
          <less-than-or-equal/>
          <right>
            <constant value="36"/>
          </right>
        </condition>
        <result>
          <variableRef variable="progression_scale_2" coefficient="3"/>
          <variableRef variable="offset"/>
          <variableRef variable="progression_scale_1_max_points"/>
          <variableRef variable="bonus"/> 
          <!-- at this point, a 10 point bonus appears, although the progression is identical. -->
        </result>
      </case>
      <case>
        <condition>
          <left>
            <variableRef variable="progression_scale_1"/>
          </left>
          <less-than-or-equal/>
          <right>
            <constant value="48"/>
          </right>
        </condition>
        <result>
          <variableRef variable="progression_scale_3" coefficient="1"/>
          <variableRef variable="offset"/>
          <variableRef variable="progression_scale_2_max_points"/>
        </result>
      </case>
      <default>
        <constant value="-1"/>
      </default>
    </switch>
  </computedGoal>
  
  
  <goal name="flexibility" title="Yellow Loops in Base" multiplier="20" max="2"/>
  
  <goal name="transitions" title="Bridge Position" initialValue="0">
    <value score="65" title="Balanced" value="balanced"/>
    <value score="45" title="Tilted" value="tilted"/>
    <value score="0" title="None" value="none"/>
  </goal>
  
  <goal name="similarity" title="Pointer is Parallel" multiplier="45"/>
  
  <goal name="ball_game_balls" title="Balls on Rack" multiplier="10" max="7"/>
  
  <goal name="ball_game_center_ball" title="Team's Ball in Center" multiplier="60"/>
  
  </Performance>
  
  <!-- TODO: Add subjective stuff. -->
</fll>