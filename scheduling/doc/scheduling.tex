\documentclass[letterpaper,11pt]{report}
\usepackage{fullpage}
\usepackage{float}
\usepackage{alltt}

% FloatBarrier
\usepackage{placeins}

% html links
\usepackage{hyperref}

% algorithm environment for pseudocode 
\usepackage{algorithm}
\usepackage{algorithmic}
\floatname{algorithm}{Constraint Set}

\title{FLL Tournament Scheduling}
\author{Jon Schewe}

\begin{document}
\maketitle

% Note: the captions on the algorithms are used in the comments for the
% constraints in the Java scheduler and verifier.
\chapter{FLL Scheduling Constraints}

\section{Definitions}

\begin{algorithmic}
\STATE $SOS$ - the start of the tournament (time 0)
\STATE $TN$ - number of teams at the tournament
\STATE $TN_{N}$ - number of division $N$ teams
\STATE $T_{0}, T_{1}, \dots, T_{n}$ - teams
\STATE $div(T_{0})$ - division of team $T_{0}$
\STATE $changetime = 15$ - time between events
\STATE $performanceChangetime = 45$ - time between performance rounds
\STATE $specialPerformanceChangetime = 30$ - time between performance
rounds for teams with opponents in a different round
\end{algorithmic}

\section{Subjective}
%TODO figure out how to put in a lunch break

Everything defined here is true for all subjective judging categories.

\begin{algorithmic}
\STATE $JN_{cat,div}$ - number of judges for category $cat$ in division $div$
\STATE $subjective_{start} = SOS$
\end{algorithmic}

\section{Performance}
\begin{algorithmic}
\STATE $TableN$ - number of tables
\STATE $coaches meeting = SOS + 30$
\STATE $performance_{start} = SOS + 60$ - give time for teams to get settled
\STATE $PN = ceil(TN / 2) / TableN$ - number of time slots for each performance round
\end{algorithmic}

\begin{algorithmic}
\STATE $P_{1} = performance_{start}$
\FOR{$round \in 2 \dots NRounds$}
  \STATE $P_{round} = P_{round-1} + 5$
\ENDFOR
\end{algorithmic}

\section{Team Constraints}
These constraints are applied to each team.

\begin{algorithm}
\caption{Relationship between each subjective category}
\begin{algorithmic}
\FOR{$category1 \in SubjectiveCategories$}
  \FOR{$category2 \in SubjectiveCategories$}
    \IF{$category1 != category2$}
      \IF{$category1_{end} <= category2_{start}$}
        \STATE $category1_{end} + changetime <= category2_{start}$
      \ELSE
        \STATE $category2_{end} + changetime <= category1_{start}$
      \ENDIF
    \ENDIF
  \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Basic constraints}
\begin{algorithmic}
\FOR{$round \in 1 \dots NRounds$}
  \STATE $P_{N_{end}} = P_{N_{start}} + 5$
\ENDFOR
\FOR{$round \in 2 \dots NRounds$}
  \STATE $P_{{N-1}_{end}} + 15 <= P_{N_{start}}$
\ENDFOR

\STATE $subjectiveCategory_{end} = subjectiveCategory_{start} + 20$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Relationships between performance rounds}
\begin{algorithmic}
\FOR{$round \in 2 \dots NRounds$}
  \STATE $P_{{N-1}_{end}} + performanceChangetime <= P_{N_{start}}$ \COMMENT FIX: Note that if the opponent is in a different round $performanceChangeTime$ needs to be $specialPerformanceChangetime$
\ENDFOR
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Relationships between subjective categories judging and performance}
\begin{algorithmic}
\FOR{$category \in SubjectiveCategories$}
  \FOR{$i \in 1 \dots 3$}
    \IF{$category_{end} <= P_{i_{start}}$}
      \STATE $category_{end} + changetime <= P_{i_{start}}$
    \ELSE
      \STATE $P_{i_{end}} + changetime <= category_{start}$
    \ENDIF
  \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Each team should always compete against other teams}
\begin{algorithmic}
\FOR{$round \in 1 \dots NRounds$}
  \STATE $opp = opponent(P_round)$
  \FOR{$r \in round+1 \dots NRounds$}
    \STATE $opp != opponent(P_r)$
  \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}


\section{Tournament Constraints}
These constraints pertain to the tournament as a whole.

\begin{algorithm}
\caption{Limit the number of teams competing on the performance tables at
  the same time}
\begin{algorithmic}

\STATE $teamsAtTime = []$
\FORALL{$T \in teams$}
  \FORALL{$i \in 1 \dots NRounds$}
    \STATE $teamsAtTime[T_{P_{i_{start}}}].append(T)$
  \ENDFOR
  \FORALL{$key \in teamsAtTime.keys()$}
    \IF{$teamsAtTime[key].size() > PN$}
      \STATE BACKTRACK - perhaps can make this a constraint?
    \ENDIF
  \ENDFOR
\ENDFOR

\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Limit the number of teams at a subjective judging station}
\begin{algorithmic}
\FORALL{$cat \in SubjectiveCategories$}
  \FORALL{$div \in divisions$}
    \STATE $teamsAtTime_{cat,div} = []$
  \ENDFOR
  \FORALL{$T \in teams$}
    \STATE $teamsAtTime_{cat,div(T)}[T_{cat_{start}}].append(T)$
  \ENDFOR
  \FORALL{$div \in divisions$}
    \FORALL{$key \in teamsAtTime_{cat,div}.keys()$}
      \IF{$teamsAtTime_{cat,div}[key].size() > JN_{cat,div}$}
        \STATE BACKTRACK - perhaps can make this a constraint?
      \ENDIF
    \ENDFOR
  \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

\FloatBarrier
\section{Implementation ideas}
Possible solvers include:
\begin{itemize}
\item \url{http://www.ict.kth.se/courses/ID2204/software.html}{Gecode/J} - isn't native Java so dropped
\item \url{http://www.koalog.com/php/jcs.php}{Koalog} - is commercial
\item \url{http://choco.emn.fr/}{Choco}
\item \url{http://jacop.osolpro.com/}{JaCoP} - implements Minizinc
\end{itemize}

\end{document}
